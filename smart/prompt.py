PROMPT = """
你是一个专业家居设备识别系统，请严格从以下设备中选择最匹配的一项或多项：
[空调, 灯光, 窗帘, 电视, 热水器, 加湿器, 除湿机, 扫地机器人, 洗衣机, 
 烘干机, 冰箱, 烤箱, 微波炉, 电饭煲, 净水器, 空气净化器, 烧水壶, 自动喂食器
 智能门锁, 摄像头, 插座, 电风扇, 暖气, 浴霸, 智能马桶, 投影仪, 电热毯]

用户指令：「{user_input}」

精准匹配规则：
1. 温度调节 → 空调/电风扇/暖气/电热毯/浴霸
2. 用水相关 → 热水器/净水器/智能马桶
3. 清洁需求 → 扫地机器人/洗衣机/烘干机/热水器
4. 空气管理 → 空气净化器/加湿器/除湿机/新风系统
5. 安防相关 → 智能门锁/摄像头
6. 厨房电器 → 冰箱/烤箱/微波炉/电饭煲
7. 影音娱乐 → 电视/投影仪
8. 睡眠场景 → 灯光/空调/电热毯

注意：
1.仅返回设备名称，按python列表格式返回，不要解释
2.不确定时返回"未知设备"
3.结合当前季节和时间信息进行推荐
4.结合用户画像进行推荐
5.示例正确格式：["灯光", "空调", "电视"]
"""

KEYWORD_MAP = {
    # 温度调节
    "热": ["空调", "电风扇"],
    "冷": ["空调", "暖气", "电热毯", "浴霸"],
    "闷": ["空调", "新风系统"],
    "凉": ["空调", "电风扇"],

    # 饮食相关
    "饿": ["电饭煲", "微波炉"],
    "做饭": ["烤箱", "微波炉"],
    "烧水": ["烧水壶", "热水器"],
    "冷藏": ["冰箱"],
    "渴": ["冰箱", "烧水壶"],
    "喝": ["冰箱", "烧水壶"],

    # 清洁场景
    "地上": ["扫地机器人"],
    "扫地": ["扫地机器人"],
    "大扫除": ["扫地机器人"],
    "脏": ["洗衣机", "烘干机"],
    "洗衣": ["洗衣机", "烘干机"],
    "除菌": ["空气净化器", "除湿机"],
    "厕所": ["智能马桶"],

    # 洗浴场景
    "洗澡": ["热水器", "浴霸"],
    "洗漱": ["智能马桶", "热水器"],

    # 安防场景
    "锁门": ["智能门锁"],
    "监控": ["摄像头"],

    # 娱乐休闲
    "看剧": ["电视", "投影仪"],
    "歌": ["电视"],  # 假设电视支持音响模式

    # 睡眠场景
    "困": ["电热毯", "灯光"],
    "睡觉": ["电热毯", "灯光"],
    "起床": ["窗帘", "灯光"],

    # 特殊需求
    "除湿": ["除湿机"],
    "加湿": ["加湿器"],
    "通风": ["新风系统", "空调"],

    # 复合场景
    "回家": ["智能门锁", "灯光", "空调"],
    "出门": ["智能门锁", "灯光", "摄像头"],

    # 宠物相关
    "喂": ["自动喂食器"],
}

# 季节权重
SEASON_DEVICE_MAP = {
    "spring": ["空气净化器", "除湿机", "扫地机器人", "烧水壶", "洗衣机", "电风扇"],
    "summer": ["空调", "电风扇", "冰箱", "除湿机", "净水器", "洗衣机"],
    "autumn": ["加湿器", "空气净化器", "烘干机", "洗衣机", "烤箱"],
    "winter": ["暖气", "空调", "电热毯", "浴霸", "智能马桶", "烧水壶", "加湿器", "热水器"],
    "all_season": ["智能门锁", "摄像头", "微波炉", "烤箱", "电饭煲", "电视", "投影仪", "灯光", "插座"],
}

# 时间维度权重
TIME_DEVICE_MAP = {
    # weekday映射
    "weekday": {
        "morning": ["灯光", "智能马桶", "热水器", "烧水壶", "微波炉"],
        "daytime": ["扫地机器人", "空气净化器"],
        "evening": ["电视", "洗衣机", "热水器", "浴霸"],
        "night": ["空调", "电热毯", "加湿器"]
    },
    # weekend映射
    "weekend": {
        "morning": ["咖啡机", "烤箱", "投影仪"],
        "daytime": ["洗衣机", "烘干机", "游戏主机"],
        "evening": ["洗碗机", "音响"],
        "night": ["空调", "夜灯"]
    }
}

# 地域特征映射
REGION_DEVICE_MAP = {
    "north": {
        "winter": ["暖气", "加湿器", "空气净化器"],
        "summer": ["空调", "电风扇"],
        "all_season": ["新风系统"]
    },
    "south": {
        "winter": ["电暖器", "除湿机", "电热毯"],
        "summer": ["空调", "除湿机", "冰箱"],
        "all_season": ["除湿机"]
    }
}

# 家庭特征设备映射
FAMILY_FEATURE_MAP = {
    "has_children": ["智能门锁", "摄像头", "空气净化器"],
    "has_elderly": ["智能马桶", "浴霸"],
    "has_pet": ["自动喂食器"],
}

# 生活习惯映射
LIFESTYLE_FEATURES_MAP = {
    "cooking": {
        "rare": ["微波炉", "烧水壶"],
        "medium": ["电饭煲", "微波炉"],
        "frequent": ["烤箱", "洗碗机", "净水器"]
    },
    "work_schedule": {
        "night_shift": ["咖啡机", "夜灯"],
        "flexible": ["投影仪", "音响"]
    }
}

# 场景关键词检测表
SCENE_KEYWORDS = {
    "家庭安防": ["安全", "门锁", "监控", "报警", "防盗", "门口", "陌生人"],
    "清洁维护": ["打扫", "清洁", "脏", "洗衣服", "收拾", "异味", "灰尘",],
    "厨房烹饪": ["做饭", "烹饪", "饿了", "食谱", "煮饭", "烘焙", "烧水"],
    "娱乐休闲": ["电影", "电视剧", "放松", "休息", "娱乐", "观看", "节目"],
    "基础生活": ["开关", "拉开", "关闭", "热水", "充电", "供电"],
    "特殊关怀": ["宠物", "喂食", "老人", "孩子", "照顾", "看护"],
    "卫浴场景": ["洗澡", "沐浴", "冲凉", "泡澡", "卫生间", "浴室",],
}
# 场景-设备映射表
SCENE_DEVICE_MAP = {
    # 家庭安防场景
    "家庭安防": ["智能门锁", "摄像头", ],
    # 清洁维护场景
    "清洁维护": ["扫地机器人", "洗衣机", "烘干机", "空气净化器", "净水器"],
    # 厨房烹饪场景
    "厨房烹饪": ["冰箱", "烤箱", "微波炉", "电饭煲", "烧水壶", "净水器"],
    # 娱乐休闲场景
    "娱乐休闲": ["电视", "投影仪", ],
    # 基础生活场景
    "基础生活": ["灯光", "窗帘", "热水器", "插座", "自动喂食器"],
    # 特殊关怀场景（老人/儿童/宠物）
    "特殊关怀": ["自动喂食器", "摄像头", "智能马桶", "浴霸"],
    # 卫浴场景
    "卫浴场景": ["热水器", "浴霸", "智能马桶", ],
}
